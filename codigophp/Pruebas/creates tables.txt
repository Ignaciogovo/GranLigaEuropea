prueba_partidos(id PK, id_local FK, id_visitante FK,goles_local,goles_visitante,id_arbitro FK,jornada, temporada FK)
prueba_temporadas(id PK,fecha_inicio,fecha_final)
prueba_Estadisticas_partido(id PK, id_jugador FK, id_partido FK,goles, amarillas, roja, titularidad)



CREATE TABLE prueba_temporadas (
  id int PRIMARY KEY NOT NULL,
  Fecha_inicio datetime,
  Fecha_final datetime
);
CREATE TABLE [prueba_partidos] (
  [id] int NOT NULL IDENTITY(1, 1) PRIMARY KEY,
  [id_local] int,
  [id_visitante] int,
  [goles_local] int,
  [goles_visitante] int,
  [id_arbitro] int,
  [aforo] varchar(10),
  [jornada] int,
  [temporada] int,
  CONSTRAINT [FK_pruebapartidos.id_arbitro]
    FOREIGN KEY ([id_arbitro])
      REFERENCES [arbitros]([id]),
  CONSTRAINT [FK_pruebapartidos.ID_LOCAL]
    FOREIGN KEY ([id_local])
      REFERENCES [club]([id]),
  CONSTRAINT [FK_pruebapartidos.id_visitante]
    FOREIGN KEY ([id_visitante])
      REFERENCES [club]([id]),
  CONSTRAINT [FK_pruebapartidos.temporada]
      FOREIGN KEY (temporada) 
      REFERENCES prueba_temporadas(id)

);

CREATE TABLE [prueba_Estadisticas_partido] (
  [id] int NOT NULL IDENTITY(1, 1) PRIMARY KEY,
  [id_jugador] int,
  [id_partido] int,
  [goles] int,
  [amarillas] int,
  [roja] int,
  [titularidad] varchar(100),
  CONSTRAINT [FK_pruebaestadisticasPartido.id_jugador]
    FOREIGN KEY ([id_jugador])
      REFERENCES [jugadores]([id]),
  CONSTRAINT [FK_pruebaestadisticasPartido.id_partido]
    FOREIGN KEY ([id_partido])
      REFERENCES [prueba_partidos]([id])
);
CREATE TABLE [prueba_estadisticasTotales] (
  [id_jugador] int NOT NULL PRIMARY KEY,
  [goles] int,
  [amarillas] int,
  [rojas] int,
  [Partidos_titular] int,
  CONSTRAINT [FK_prueba_estadisticasTotales.id_jugador]
    FOREIGN KEY ([id_jugador])
      REFERENCES [jugadores]([id])
);
CREATE TABLE [prueba_clasificacion] (
  [id_club] int NOT NULL IDENTITY(1, 1) PRIMARY KEY,
  [puntos] int,
  [golesAfavor] int,
  [golesEncontra] int,
  CONSTRAINT [FK_pruebaclasificacion.id_club]
    FOREIGN KEY ([id_club])
      REFERENCES [club]([id])
);
INSERT INTO [prueba_clasificacion] (id_club,puntos,golesAfavor,golesEncontra)
VALUES
  (1,0,0,0),
  (2,0,0,0),
  (3,0,0,0),
  (4,0,0,0),
  (5,0,0,0),
  (6,0,0,0),
  (7,0,0,0),
  (8,0,0,0),
  (9,0,0,0),
  (10,0,0,0);
INSERT INTO [prueba_clasificacion] (id_club,puntos,golesAfavor,golesEncontra)
VALUES
  (11,0,0,0),
  (12,0,0,0),
  (13,0,0,0),
  (14,0,0,0),
  (15,0,0,0),
  (16,0,0,0);



  --prueba_estadisticasTotales
 set @i = 1;
  declare @jugador as int;
  while  @i<= @a
  begin
  select @jugador = id from jugadores where id = @i;
  INSERT INTO [prueba_estadisticasTotales] (id_jugador,goles,amarillas,rojas,Partidos_titular)
  VALUES
  (@jugador,0,0,0,0);
  set @i= @i +1;
  end